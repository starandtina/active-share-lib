!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("jquery"),require("underscore"),require("html-wrapper")):"function"==typeof define&&define.amd?define(["backbone","jquery","underscore","html-wrapper"],t):"object"==typeof exports?exports.ActiveShareLib=t(require("backbone"),require("jquery"),require("underscore"),require("html-wrapper")):e.ActiveShareLib=t(e.backbone,e.jquery,e.underscore,e["html-wrapper"])}(this,function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(2)},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){e&&(p["default"].isFunction(e.stopListening)&&e.stopListening(),p["default"].isFunction(e.stopListeningToAll)&&e.stopListeningToAll())}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),f=i(a),c=n(4),d=i(c),h=n(5),p=i(h),v=n(6),m=i(v);f["default"].View.prototype.close=function(){return p["default"].chain(this.$el.find("[data-render]").toArray()).filter(function(e){return(0,d["default"])(e).data("_impl")}).map(function(e){return m["default"].getComponent(e)}).compact().filter(function(e){return p["default"].isFunction(e.dispose)}).invoke("dispose"),this.onClose&&this.onClose(),u.call(this,this.model),u.call(this,this.collection),this.$el.remove(),this.stopListening(),this.off(),this};var y=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));n.name=null,n.parentView=null,p["default"].bindAll.apply(p["default"],[n].concat(p["default"].functions(n))),n.options=p["default"].extend(n.options||{},e||{}),n.name=n.name||p["default"].uniqueId("view");var i=[].concat(n.mixins);return p["default"].forEach(i,function(e){p["default"].extend(this,e)},n),n}return l(t,e),s(t,[{key:"getInnerHtml",value:function(){var e=this.getTemplate(),t=this.getTemplateData();if(this._preRender(),null==e)throw new Error(this.name+': template "'+this.getTemplateName()+'" not found.');return m["default"].localize.parse(e(t))}},{key:"getTemplate",value:function(){return this.template}},{key:"getTemplateName",value:function(){return this.name}},{key:"getTemplateData",value:function(){var e,t;return this.model?e=this.model.toJSON():this.collection&&(e={models:this.collection.toJSON(),meta:this.collection.meta,params:this.collection.params}),t=p["default"].omit(this.options,["model","collection","meta","params"]),p["default"].extend({},e,t)}},{key:"getAttributes",value:function(){var e={};return e["data-view"]=this.name,e}},{key:"_preRender",value:function(){this.trigger("preRender")}},{key:"_postRender",value:function(){return this.removeChildViews(),this.addReferences(),this.trigger("postRender"),this}},{key:"_preRenderComponents",value:function(){this.trigger("preRenderComponents")}},{key:"_postRenderComponents",value:function(){var e=this._references||p["default"].result(this,"references");for(var t in e)this[t]=m["default"].getComponent(this.$(e[t]));this.trigger("postRenderComponents")}},{key:"onRenderComponentsDone",value:function(){m["default"].app.applyPermissionsToHtml(this.$el),m["default"].app.applyFeaturesToHtml(this.$el),this._postRenderComponents()}},{key:"render",value:function(){var e=this,t=this.getInnerHtml();return this.$el.html(t),this.$el.attr(this.getAttributes()),this._postRender(),this._preRenderComponents(),m["default"].render(this.$el,function(){return e.onRenderComponentsDone()}),this}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"preRenderComponents",value:function(){}},{key:"postRenderComponents",value:function(){}},{key:"registerChildView",value:function(e,t){var n=this.getChildViews();return t=t||e.cid,n[t]=e,e.el&&(e.parent=e.parentView=this),e}},{key:"registerSubview",value:function(){this.registerChildView.apply(this,arguments)}},{key:"renderChildViews",value:function(e,t){var n;return p["default"].isObject(e)?n=e:(n={},n[e]=t),n?(p["default"].each(n,function(e,t){e.parent=e.parentView=this,e.selector=t,e.appendToParent?(e.name=t,e.render(),this.$el.append(e.el)):e.setElement(this.$(t)).render(),this.registerChildView(e)},this),this):void 0}},{key:"assign",value:function(){this.renderChildViews.apply(this,arguments)}},{key:"where",value:function(e,t){var n=p["default"].matches(e),i=this.getChildViews();return this[t?"find":"filter"](i,function(e){return n(e)})}},{key:"find",value:function(){return p["default"].find.apply(p["default"],arguments)}},{key:"filter",value:function(){return p["default"].filter.apply(p["default"],arguments)}},{key:"findWhere",value:function(e){return this.where(e,!0)}},{key:"getChildViewsByName",value:function(e){return this.where({name:e})}},{key:"getChildViewByName",value:function(e){return this.findWhere({name:e})}},{key:"getChildViewBySelector",value:function(e){return this.findWhere({selector:e})}},{key:"getSubViewBySelector",value:function(){return this.getChildViewBySelector.apply(this,arguments)}},{key:"trigger",value:function(e){return p["default"].isFunction(this[e])&&this[e].apply(this,[].slice.call(arguments,1)),f["default"].View.prototype.trigger.apply(this,arguments),this}},{key:"renderCollection",value:function(e,t,n,i){function r(e){return p["default"].find(s,function(t){return e===t.model})}function o(e,i,o){var l,c=a.filter?a.filter(e):!0;c&&(e.set("_isLast",o.length-1===i,{silent:!0}),l=r(e),l||(l=new t(p["default"].chain({model:e,collection:o}).extend(a.viewOptions).value()),s.push(l),l.parent=u,l.renderedByParentView=!0,l.render({containerEl:n}),u.registerChildView(l)),l.insertSelf||f[a.reverse?"prepend":"append"](l.el),l.delegateEvents())}function l(){if(0!==e.length){var t=f[0],n=p["default"].toArray(t.childNodes);p["default"].each(n,function(e){t.removeChild(e)}),e.each(o)}}var u=this,s=[],a=p["default"].defaults(i||{},{filter:null,viewOptions:{},reverse:!1}),f=this.$(n);this.listenTo(e,"add",o),this.listenTo(e,"remove",function(e){var t=s.indexOf(r(e));-1!==t&&s.splice(t,1)[0].remove()}),this.listenTo(e,"move sort",l),this.listenTo(e,"refresh reset",function(){for(;s.length;)s.pop().remove();l()}),l()}},{key:"addReferences",value:function(e){e=e||p["default"].result(this,"references"),this._references=p["default"].defaults({},this._references,e);for(var t in e)this["$"+t]=this.$(e[t])}},{key:"references",value:function(){return p["default"].reduce(p["default"].result(this,"dom")||{},function(e,t,n){return e[p["default"].camelize(n.toLocaleLowerCase())]=t,e},{})}},{key:"remove",value:function(){this.removeChildViews(),this.childViews=null,this.parentView=null;var e=this.model||this.collection;e&&e.off(null,null,this),this.close()}},{key:"exit",value:function(e){this.remove(),e&&e.complete()}},{key:"removeChildViews",value:function(){return p["default"].forEach(this.getChildViews(),function(e,t){this.removeChildView(e,t)},this),this}},{key:"removeChildView",value:function(e,t){t=t||e.cid,e&&p["default"].isFunction(e.close)&&e.close();var n=this.getChildViews();delete n[t]}},{key:"getChildViews",value:function(){return this.childViews=this.childViews||{},this.childViews}},{key:"enter",value:function(){return this.render(),this.$el}}]),t}(f["default"].View);t["default"]=y,e.exports=t["default"]},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=i}])});